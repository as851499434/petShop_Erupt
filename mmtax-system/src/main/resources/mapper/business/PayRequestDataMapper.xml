<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mmtax.business.mapper.PayRequestDataMapper">

    <resultMap type="com.mmtax.business.domain.PayRequestData" id="PayRequestDataResult">
        <result property="id"    column="id"    />
        <result property="taskRecordBatchNo"    column="task_record_batch_no"    />
        <result property="batchPaymentRecordId"    column="batch_payment_record_id"    />
        <result property="merchantId"    column="merchant_id"    />
        <result property="amount"    column="amount"    />
        <result property="taxRate"    column="tax_rate"    />
        <result property="charge"    column="charge"    />
        <result property="inOutDeduction"    column="in_out_deduction"    />
        <result property="merchantSerialNum"    column="merchant_serial_num"    />
        <result property="name"    column="name"    />
        <result property="mobile"    column="mobile"    />
        <result property="bankCard"    column="bank_card"    />
        <result property="idCardNo"    column="id_card_no"    />
        <result property="status"    column="status"    />
        <result property="paymentChannel"    column="payment_channel"    />
        <result property="remark"    column="remark"    />
        <result property="comment"    column="comment"    />
        <result property="useBigRate"    column="use_big_rate"    />
        <result property="providerId"    column="provider_id"    />
        <result property="delStatus"    column="del_status"    />
        <result property="promotionStatus"    column="promotion_status"    />
        <result property="province"    column="province"    />
        <result property="city"    column="city"    />
        <result property="area"    column="area"    />
        <result property="street"    column="street"    />
        <result property="community"    column="community"    />
        <result property="unitPrice"    column="unit_price"    />
        <result property="quantity"    column="quantity"    />
        <result property="promotionStartTime"    column="promotion_start_time"    />
        <result property="promotionEndTine"    column="promotion_end_tine"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateTime"    column="update_time"    />
    </resultMap>
    <select id="selectListPagination" resultMap="PayRequestDataResult">
        select * from tbl_pay_request_data
        where batch_payment_record_id = #{batchRecordId}
        and del_status = 0
        <if test="pageSize != null">
            limit #{startIndex},#{pageSize}
        </if>
    </select>

    <select id="getCountByStatus" resultType="java.lang.Integer">
    SELECT
	count(0)
    FROM
	tbl_pay_request_data t1
	LEFT JOIN tbl_batch_payment_record t2 ON t2.id = t1.batch_payment_record_id
    WHERE
	t1.merchant_id = #{merchantId}
	AND t2.batch_no = #{batchNo}
	AND t1.STATUS = 0
    </select>

</mapper>